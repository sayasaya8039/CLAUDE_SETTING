chrome.runtime.onInstalled.addListener(e=>{console.log("X Thread Maker installed:",e.reason),e.reason==="install"&&chrome.storage.local.set({x_thread_maker_settings:{llmConfig:{provider:"anthropic",apiKey:"",model:"claude-sonnet-4-20250514"},maxCharsPerPost:140,includeNumbering:!0,autoAddContinue:!0}})});chrome.runtime.onInstalled.addListener(()=>{chrome.contextMenus.create({id:"x-thread-maker-create",title:"X Thread Makerã§ã‚¹ãƒ¬ãƒƒãƒ‰ä½œæˆ",contexts:["selection"]})});chrome.contextMenus.onClicked.addListener((e,t)=>{e.menuItemId==="x-thread-maker-create"&&e.selectionText&&(chrome.storage.local.set({x_thread_maker_selected_text:e.selectionText}),t!=null&&t.id&&chrome.scripting.executeScript({target:{tabId:t.id},func:a}))});function a(){const e=document.createElement("div");e.id="x-thread-maker-selection-notification",Object.assign(e.style,{position:"fixed",top:"20px",right:"20px",background:"#1d9bf0",color:"white",padding:"12px 16px",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:"10000",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",fontSize:"14px"}),e.textContent="ðŸ“‹ ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚æ‹¡å¼µæ©Ÿèƒ½ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ä½œæˆ",document.body.appendChild(e),setTimeout(()=>{e.remove()},3e3)}chrome.runtime.onMessage.addListener((e,t,r)=>{switch(e.type){case"GET_SELECTED_TEXT":return chrome.storage.local.get(["x_thread_maker_selected_text"],o=>{r({text:o.x_thread_maker_selected_text||""}),chrome.storage.local.remove("x_thread_maker_selected_text")}),!0;case"OPEN_X_COMPOSE":{chrome.tabs.create({url:"https://x.com/compose/tweet"}),r({success:!0});break}default:r({success:!1,error:"Unknown message type"})}return!0});console.log("X Thread Maker: Background service worker started");
