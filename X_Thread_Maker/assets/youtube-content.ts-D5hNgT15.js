(function(){chrome.runtime.onMessage.addListener((r,n,o)=>(r.type==="GET_YOUTUBE_CONTENT"&&d().then(o),!0));async function d(){var c,s;const r=document.querySelector("h1.ytd-video-primary-info-renderer yt-formatted-string, h1.ytd-watch-metadata yt-formatted-string, #title h1 yt-formatted-string"),n=((c=r==null?void 0:r.textContent)==null?void 0:c.trim())||"",o=document.querySelector("#expand, tp-yt-paper-button#expand");o&&(o.click(),await new Promise(u=>setTimeout(u,300)));const a=document.querySelector("#description-inline-expander, ytd-text-inline-expander, #description-inner"),i=((s=a==null?void 0:a.innerText)==null?void 0:s.trim())||"",t=await l();let e=`【${n}】

`;return i&&(e+=`■ 説明文
${i}

`),t&&(e+=`■ 字幕・トランスクリプト
${t}`),{title:n,content:e.trim()}}async function l(){var i;if(!document.querySelector('button[aria-label="文字起こしを表示"], button[aria-label="Show transcript"]')){const t=document.querySelector("tp-yt-paper-button#expand, #description-inline-expander tp-yt-paper-button");if(t&&(t.click(),await new Promise(c=>setTimeout(c,500))),!document.querySelector('button[aria-label="文字起こしを表示"], button[aria-label="Show transcript"], ytd-button-renderer:has-text("文字起こし")'))return null}let n=document.querySelector("ytd-transcript-renderer, ytd-engagement-panel-section-list-renderer[target-id='engagement-panel-searchable-transcript']");if(!n){const t=document.querySelector('button[aria-label="文字起こしを表示"], button[aria-label="Show transcript"]');t&&(t.click(),await new Promise(e=>setTimeout(e,1e3))),n=document.querySelector("ytd-transcript-renderer, ytd-engagement-panel-section-list-renderer[target-id='engagement-panel-searchable-transcript']")}if(!n)return null;const o=n.querySelectorAll("ytd-transcript-segment-renderer, .ytd-transcript-segment-renderer"),a=[];for(const t of o){const e=(i=t.textContent)==null?void 0:i.trim();e&&a.push(e)}return a.join(" ")}console.log("X Thread Maker: YouTube content script loaded");
})()
