(function(){chrome.runtime.onMessage.addListener((t,o,e)=>{switch(t.type){case"INSERT_TO_X":l(t.payload.content),e({success:!0});break;case"INSERT_THREAD_TO_X":m(t.payload.posts),e({success:!0});break;default:e({success:!1,error:"Unknown message type"})}return!0});function l(t){const o=['[data-testid="tweetTextarea_0"]','[data-testid="tweetTextarea"]','[role="textbox"][data-contents="true"]',".public-DraftEditor-content",'[contenteditable="true"][role="textbox"]'];let e=null;for(const n of o)if(e=document.querySelector(n),e)break;if(!e){const n=document.querySelector('[data-testid="SideNav_NewTweet_Button"]');if(n){n.click(),setTimeout(()=>l(t),500);return}console.error("X Thread Maker: ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");return}e.focus(),e.classList.contains("public-DraftEditor-content")?p(e,t):x(e,t)}function p(t,o){t.focus();const e=new InputEvent("beforeinput",{inputType:"insertText",data:o,bubbles:!0,cancelable:!0});t.dispatchEvent(e),document.execCommand("insertText",!1,o)}function x(t,o){const e=t;e.focus();const n=window.getSelection();n&&(n.selectAllChildren(e),n.collapseToEnd()),document.execCommand("insertText",!1,o)}function m(t){t.length!==0&&(l(t[0]),t.length>1&&b(t.slice(1)))}function b(t){const o=document.getElementById("x-thread-maker-notification");o&&o.remove();const e=document.createElement("div");e.id="x-thread-maker-notification",Object.assign(e.style,{position:"fixed",bottom:"20px",right:"20px",background:"#1d9bf0",color:"white",padding:"16px 20px",borderRadius:"16px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:"10000",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",maxWidth:"300px"});const n=document.createElement("div");n.textContent="ðŸ“ ã‚¹ãƒ¬ãƒƒãƒ‰æŠ•ç¨¿ä¸­",Object.assign(n.style,{fontWeight:"bold",marginBottom:"8px"}),e.appendChild(n);const r=document.createElement("div");r.id="x-thread-maker-count",r.textContent=`æ®‹ã‚Š ${t.length} ãƒã‚¹ãƒˆ`,Object.assign(r.style,{fontSize:"14px",marginBottom:"12px"}),e.appendChild(r);const i=document.createElement("div");Object.assign(i.style,{display:"flex",gap:"8px"});const d=document.createElement("button");d.textContent="æ¬¡ã¸",Object.assign(d.style,{background:"white",color:"#1d9bf0",border:"none",padding:"8px 16px",borderRadius:"20px",fontWeight:"bold",cursor:"pointer"});const c=document.createElement("button");c.textContent="å…¨ã¦ã‚³ãƒ”ãƒ¼",Object.assign(c.style,{background:"transparent",color:"white",border:"1px solid white",padding:"8px 16px",borderRadius:"20px",cursor:"pointer"});const s=document.createElement("button");s.textContent="âœ•",Object.assign(s.style,{background:"transparent",color:"white",border:"none",padding:"8px",cursor:"pointer",marginLeft:"auto"}),i.appendChild(d),i.appendChild(c),i.appendChild(s),e.appendChild(i),document.body.appendChild(e);let a=0;d.addEventListener("click",()=>{a<t.length&&(l(t[a]),a++,r.textContent=`æ®‹ã‚Š ${t.length-a} ãƒã‚¹ãƒˆ`,a>=t.length&&e.remove())}),c.addEventListener("click",()=>{const u=t.join(`

---

`);navigator.clipboard.writeText(u),c.textContent="ã‚³ãƒ”ãƒ¼æ¸ˆã¿"}),s.addEventListener("click",()=>{e.remove()}),setTimeout(()=>{e.remove()},6e5)}console.log("X Thread Maker: X.com content script loaded");
})()
