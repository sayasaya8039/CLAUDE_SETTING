(function(){chrome.runtime.onMessage.addListener((r,n,l)=>{if(r.type==="GET_NOTE_CONTENT"){const e=i();l(e)}return!0});function i(){var t;const r=document.querySelector("h1.o-noteContentHeader__title, h1[class*='noteContentHeader__title'], .p-article__title"),n=((t=r==null?void 0:r.textContent)==null?void 0:t.trim())||"",l=[".note-common-styles__textnote-body",".p-article__content",'[class*="noteContentBody"]',".note-body","article .note-common-styles__textnote-body"];let e=null;for(const o of l)if(e=document.querySelector(o),e)break;if(!e)return null;const s=d(e);return{title:n,content:s.trim()}}function d(r){var s;const n=[],l=document.createTreeWalker(r,NodeFilter.SHOW_ALL,{acceptNode:t=>{var o,c;return((o=t.parentElement)==null?void 0:o.tagName)==="SCRIPT"||((c=t.parentElement)==null?void 0:c.tagName)==="STYLE"?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}});let e=!1;for(;l.nextNode();){const t=l.currentNode;if(t.nodeType===Node.TEXT_NODE){const o=(s=t.textContent)==null?void 0:s.trim();o&&(e&&(n.push(`

`),e=!1),n.push(o))}else if(t.nodeType===Node.ELEMENT_NODE){const c=t.tagName.toLowerCase();if(["p","div","h1","h2","h3","h4","h5","h6","br","li"].includes(c)&&(e=!0),c.match(/^h[1-6]$/)){const a=Number.parseInt(c[1]);n.push(`
${"#".repeat(a)} `),e=!1}c==="li"&&(n.push(`
â€¢ `),e=!1)}}return n.join("")}console.log("X Thread Maker: note.com content script loaded");
})()
