(function(){chrome.runtime.onMessage.addListener((o,e,n)=>(o.type==="GET_YOUTUBE_CONTENT"&&s().then(n),!0));async function s(){var r,c;const o=document.querySelector("h1.ytd-video-primary-info-renderer yt-formatted-string, h1.ytd-watch-metadata yt-formatted-string"),e=((r=o==null?void 0:o.textContent)==null?void 0:r.trim())||"",n=document.querySelector("#description-inline-expander yt-attributed-string, ytd-text-inline-expander yt-attributed-string, #description yt-formatted-string"),a=((c=n==null?void 0:n.textContent)==null?void 0:c.trim())||"",i=await u();let t=`【${e}】

`;return a&&(t+=`■ 説明文
${a}

`),i&&(t+=`■ 字幕・トランスクリプト
${i}`),{title:e,content:t.trim()}}async function u(){var i;if(!document.querySelector('button[aria-label="文字起こしを表示"], button[aria-label="Show transcript"]')){const t=document.querySelector("tp-yt-paper-button#expand, #description-inline-expander tp-yt-paper-button");if(t&&(t.click(),await new Promise(c=>setTimeout(c,500))),!document.querySelector('button[aria-label="文字起こしを表示"], button[aria-label="Show transcript"], ytd-button-renderer:has-text("文字起こし")'))return null}let e=document.querySelector("ytd-transcript-renderer, ytd-engagement-panel-section-list-renderer[target-id='engagement-panel-searchable-transcript']");if(!e){const t=document.querySelector('button[aria-label="文字起こしを表示"], button[aria-label="Show transcript"]');t&&(t.click(),await new Promise(r=>setTimeout(r,1e3))),e=document.querySelector("ytd-transcript-renderer, ytd-engagement-panel-section-list-renderer[target-id='engagement-panel-searchable-transcript']")}if(!e)return null;const n=e.querySelectorAll("ytd-transcript-segment-renderer, .ytd-transcript-segment-renderer"),a=[];for(const t of n){const r=(i=t.textContent)==null?void 0:i.trim();r&&a.push(r)}return a.join(" ")}console.log("X Thread Maker: YouTube content script loaded");
})()
